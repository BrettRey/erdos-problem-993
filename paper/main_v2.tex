% !TEX TS-program = xelatex
\documentclass[12pt,oneside]{article}
\input{preamble.tex}

% ============================
% Additional packages
% ============================
\usepackage{amsthm}

% Load local bibliography
\addbibresource{references-local.bib}

% APA style suppresses eprint fields; append arXiv links at end of each entry
\DeclareFieldFormat{eprint:arXiv}{%
  \ifhyperref
    {\href{https://arxiv.org/abs/#1}{arXiv:\space #1}}
    {arXiv:\space #1}%
}
\renewbibmacro{finentry}{%
  \iffieldundef{eprint}{}{%
    \newunit\newblock
    \printfield[eprint:\strfield{eprinttype}]{eprint}%
  }%
  \finentry
}

% Theorem environments (numbered within sections, shared counter)
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}[theorem]{Definition}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

% ============================
% Notation macros
% ============================
\newcommand{\indpoly}{I(T;\,x)}           % independence polynomial
\newcommand{\ik}{i_k(T)}                  % coefficient
\newcommand{\nm}{\mathrm{nm}}             % near-miss ratio
\newcommand{\broom}{\mathrm{B}}           % broom notation
\newcommand{\dleaf}{d_{\mathrm{leaf}}}    % leaf-degree
\newcommand{\priv}{\mathrm{priv}}         % private neighbor count

% ============================
% Metadata
% ============================
\title{A subdivision-contraction identity and structural reductions\\
  for tree independence polynomial unimodality}
\author{Brett Reynolds\,\orcidlink{0000-0003-2407-9448}}
\date{}

\begin{document}
\maketitle

\begin{abstract}
\textcite{alavi1987} conjectured that the independence polynomial of every tree is unimodal.
I prove that for any tree~$T$ and edge~$e$, the subdivided tree~$T_e$ and the contracted tree~$T/e$ satisfy $I(T_e;\, x) = I(T;\, x) + x \cdot I(T/e;\, x)$.
This identity reduces subdivision to a conjectured mode stability property: that edge contraction shifts the mode by at most~1.
I verify this Edge Contraction Mode Stability conjecture for all 24.7~million edges in trees on at most 20~vertices, finding zero violations.
Together with a verified tail condition, ECMS implies that subdivision preserves unimodality, so any minimal counterexample is homeomorphically irreducible.
Independently, I prove a chain of structural lemmas~-- a Hub Exclusion Lemma and a Transfer Lemma~-- showing that the mode bound for all trees reduces to a single conjecture about trees in which every vertex has at most one leaf-child.
This Conjecture~A is verified for 931\,596 such trees through $n = 23$.
A proved singleton compensation lemma gives a direct path via a weighted Hall condition on the heavy vertices.
On the computational side, I verify the original conjecture exhaustively for all 1\,198\,738\,056 trees on $n \le 27$ vertices, confirming the bound implicit in the log-concavity check of \textcite{kadrawi2023} and supplementing it with near-miss metrics through $n = 26$.
An evolutionary search identifies multi-arm stars as the family closest to the unimodality boundary, surpassing brooms.
The near-miss ratio satisfies $\nm(s) = 1 - C/s + O(1/s^2)$ with $C \in [4, 8)$, so the margin shrinks but doesn't vanish.
\end{abstract}

\section{Introduction}\label{sec:intro}

An \emph{independent set} in a graph~$G$ is a set of vertices no two of which are adjacent.
Write $i_k(G)$ for the number of independent sets of size~$k$ and $\alpha(G)$ for the independence number.
The \emph{independence polynomial} is $I(G;\, x) = \sum_{k=0}^{\alpha(G)} i_k(G)\, x^k$, with $i_0 = 1$.

\begin{conjecture}[\citealp{alavi1987}]\label{conj:main}
  For every tree~$T$, the sequence $i_0(T), i_1(T), \dotsc, i_{\alpha(T)}(T)$ is unimodal.
\end{conjecture}

\textcite{alavi1987} showed that the independence sequence of a general graph can realize any prescribed shape, but conjectured that trees are constrained enough to force unimodality.
The stronger property of log-concavity ($i_k^2 \ge i_{k-1}\, i_{k+1}$ for all~$k$) held for all trees tested until $n = 26$, when \textcite{kadrawi2023} found exactly two log-concavity failures.
\textcite{galvin2025} subsequently constructed infinite families of subdivided stars with log-concavity failures arbitrarily far from the ends of the sequence, and \textcite{ramos2025} used machine learning to find tens of thousands more, but no unimodality failure.

On the positive side, unimodality has been proved for paths and centipedes \citep{alavi1987}, regular caterpillars, and Fibonacci trees.
\textcite{levit2006} showed that $i_k(T)$ is strictly decreasing for $k \ge \lceil (2\alpha - 1)/3 \rceil$, so any violation has to occur in roughly the first two-thirds of the sequence.
\textcite{heilman2025} proved that for a uniformly random labelled tree, roughly 85\% of the sequence behaves as expected almost surely.
\textcite{li2025spiders} proved that all spiders are strongly log-concave, implying unimodality for brooms as a special case.

My contributions:
\begin{enumerate}
  \item A subdivision-contraction identity: $I(T_e) = I(T) + x \cdot I(T/e)$ for any tree edge~$e$ (Section~\ref{sec:identity}).
  \item A conjectured Edge Contraction Mode Stability (ECMS) property, verified for 24.7~million edges (Section~\ref{sec:identity}).
  \item A conditional subdivision lemma: ECMS and a verified tail condition together imply subdivision preserves unimodality, so any minimal counterexample is homeomorphically irreducible (Section~\ref{sec:identity}).
  \item A reduction framework~-- via Hub Exclusion and Transfer Lemmas~-- reducing the mode bound for all trees to a single conjecture about $\dleaf \le 1$ trees (Section~\ref{sec:reduction}).
  \item A proof that $\mu(T) < n/3$ for every $\dleaf \le 1$ tree~$T$, via a decimation identity and Steiner peeling on the heavy-vertex compensation function (Section~\ref{sec:reduction}).
  \item Exhaustive verification for all trees on $n \le 27$ vertices, with near-miss metrics through $n = 26$ (Section~\ref{sec:exhaustive}).
  \item Identification of multi-arm stars as the extremal family and an asymptotic analysis of the near-miss ratio (Section~\ref{sec:extremal}).
\end{enumerate}


\section{Definitions and method}\label{sec:method}

\begin{definition}\label{def:unimodal}
  A finite sequence $(a_0, a_1, \dotsc, a_m)$ of positive reals is \emph{unimodal} if there exists an index~$p$ such that $a_0 \le a_1 \le \dotsb \le a_p \ge a_{p+1} \ge \dotsb \ge a_m$.
  It is \emph{log-concave} if $a_k^2 \ge a_{k-1}\, a_{k+1}$ for all $1 \le k \le m-1$.
\end{definition}

Log-concavity (with positive terms) implies unimodality, but not conversely.
For a unimodal sequence, the \emph{mode} is the index~$p$ of the maximum; if the maximum is achieved at multiple indices, I take the largest.

To quantify proximity to a violation, define the \emph{near-miss ratio}~$\nm(T)$.
Let $j_0$ be the first index where $i_{j_0} > i_{j_0+1}$ (the first strict descent).
Then $\nm(T) = \max_{j > j_0} i_{j+1}(T)/i_j(T)$.
A value exceeding~1 indicates a violation; a value near~1 indicates the tree nearly violates unimodality.

The independence polynomial is computed by rooting~$T$ at an arbitrary vertex and traversing bottom-up.
For each vertex~$v$, define two polynomials for the subtree rooted at~$v$:
\begin{align}
  P_v(x) &= x \cdot \prod_{c \,\in\, \mathrm{children}(v)} R_c(x), \label{eq:Pv}\\
  R_v(x) &= \prod_{c \,\in\, \mathrm{children}(v)} \bigl(P_c(x) + R_c(x)\bigr), \label{eq:Rv}
\end{align}
where $P_v$ counts independent sets in the subtree that include~$v$, and $R_v$ counts those that exclude~$v$.
The full polynomial is $I(T;\, x) = P_r + R_r$ for the root~$r$.

For an edge $e = uv$ in~$T$, the \emph{contraction} $T/e$ is the tree obtained by identifying $u$ and~$v$ into a single vertex~$w$ whose neighbors are those of~$u$ and~$v$ (excluding $u$ and~$v$ themselves).
The \emph{subdivision} $T_e$ inserts a new degree-2 vertex on~$e$.
A tree is \emph{homeomorphically irreducible} if it has no degree-2 vertex; equivalently, it is not the subdivision of a smaller tree.

Non-isomorphic trees on~$n$ vertices are enumerated with \texttt{nauty/geng} \citep{mckay2014}, parallelized across eight workers.
Polynomial arithmetic uses \texttt{numpy.convolve} when coefficients fit in 64-bit integers, with automatic fallback to pure Python big-integer arithmetic for larger values.
Log-concavity is checked in exact integer arithmetic, avoiding floating-point error.


\section{The subdivision-contraction identity}\label{sec:identity}

For an edge $e = uv$ in tree~$T$, removing~$e$ splits $T$ into two subtrees: $T_u$ containing~$u$ and $T_v$ containing~$v$.
Root $T_u$ at~$u$ and $T_v$ at~$v$, and write $I_u = P_u + R_u$ and $I_v = P_v + R_v$ as above.

\begin{theorem}[Subdivision-contraction identity]\label{thm:identity}
  For any tree~$T$ and edge $e = uv$,
  \[
    I(T_e;\, x) \;=\; I(T;\, x) \;+\; x \cdot I(T/e;\, x).
  \]
\end{theorem}

\begin{proof}
I establish three expressions in terms of $P_u, R_u, P_v, R_v$.

\emph{Subdivision.}
Let $w$ be the new vertex in~$T_e$.
If $w \notin S$, deleting~$w$ leaves $T_u$ and $T_v$ as disconnected components with no edge between $u$ and~$v$, so any IS of~$T_u$ combines freely with any IS of~$T_v$; the contribution is $I_u I_v$.
If $w \in S$, then $u$ and $v$ are both excluded; the contribution is $x\, R_u R_v$.
So
\begin{equation}\label{eq:subdiv}
  I(T_e) = I_u I_v + x\, R_u R_v.
\end{equation}

\emph{Original tree.}
Any IS of~$T$ restricts to an IS of~$T_u$ and an IS of~$T_v$, with the constraint that $u$ and $v$ can't both be included (since they're adjacent in~$T$).
Summing all pairs and subtracting the forbidden case:
\begin{equation}\label{eq:original}
  I(T) = I_u I_v - P_u P_v.
\end{equation}

\emph{Contraction.}
Let $w'$ be the merged vertex in~$T/e$.
If $w' \notin S$, the subtrees rooted at children of~$u$ (in~$T_u$) and children of~$v$ (in~$T_v$) are independent, contributing $R_u R_v$.
If $w' \in S$, all neighbors of~$w'$ are excluded; the contribution is $x \cdot (P_u/x)(P_v/x) = P_u P_v / x$.
This quotient is a polynomial because $P_u$ and $P_v$ are each divisible by~$x$ (any IS including a vertex has size~$\ge 1$).
So
\begin{equation}\label{eq:contract}
  I(T/e) = R_u R_v + P_u P_v / x.
\end{equation}

Combining \eqref{eq:subdiv}--\eqref{eq:contract}:
\[
  I(T_e) - I(T) = P_u P_v + x\, R_u R_v = x \cdot I(T/e). \qedhere
\]
\end{proof}

The identity says that the \enquote{extra} independent sets created by subdivision are exactly a shifted copy of the contraction's IS polynomial.
I verified \eqref{eq:subdiv}--\eqref{eq:contract} computationally for 66\,697 edges in trees on $n \le 14$, with zero mismatches.

\begin{remark}
  The identity can also be derived from the standard vertex-deletion formula $I(G) = I(G - v) + x \cdot I(G - N[v])$ applied to the subdivision vertex~$w$: deleting~$w$ gives the graph $T_u \sqcup T_v$ (with IS polynomial $I_u I_v$), and deleting $N[w] = \{w, u, v\}$ gives $(T_u - u) \sqcup (T_v - v)$ (contributing $R_u R_v$).
  I haven't found this particular corollary~-- connecting subdivision, original, and contraction~-- stated in the literature, including the work of \textcite{levit2006} and the edge elimination polynomial framework.
\end{remark}

The identity naturally leads to the following question: if $I(T)$ and $I(T/e)$ are both unimodal, when is their combination $I(T) + x \cdot I(T/e)$ unimodal?
Since $x \cdot I(T/e)$ has mode $\mathrm{mode}(I(T/e)) + 1$, the answer depends on how far apart the modes of the two summands are.

\begin{conjecture}[Edge Contraction Mode Stability]\label{conj:ecms}
  For any tree~$T$ and edge~$e$,
  \[
    \bigl|\mathrm{mode}(I(T)) - \mathrm{mode}(I(T/e))\bigr| \;\le\; 1.
  \]
\end{conjecture}

I verified ECMS for all 24\,710\,099 edges in non-isomorphic trees on $n \le 20$.
Zero violations were found.
The distribution of $\mathrm{mode}(I(T/e)) - \mathrm{mode}(I(T))$ is $-1$ in 26.6\%, $0$ in 73.3\%, and $+1$ in 0.09\% of cases.

The identity already constrains the mode of $I(T_e)$ without any conjecture:

\begin{proposition}[Mode sandwich]\label{prop:sandwich}
  If $I(T)$ and $I(T/e)$ are both unimodal with modes $m$ and $m'$ respectively, then $I(T_e) = I(T) + x \cdot I(T/e)$ attains its maximum at some $k \in [\min(m,\, m'{+}1),\, \max(m,\, m'{+}1)]$.
\end{proposition}

\begin{proof}
  Write $A(x) = x \cdot I(T/e;\, x)$, which is unimodal with mode $m'{+}1$.
  For $k < \min(m,\, m'{+}1)$, both $I(T)$ and~$A$ are non-decreasing, so their sum is non-decreasing.
  For $k \ge \max(m,\, m'{+}1)$, both are non-increasing, so their sum is non-increasing.
\end{proof}

I verified the mode sandwich for all 3\,348\,674 edges in trees on $n \le 18$, with zero failures.
An immediate consequence is that $\mathrm{mode}(I(T_e)) - \mathrm{mode}(I(T)) \in \{0, 1\}$ whenever ECMS holds: if $m' \ge m - 1$, then $m' + 1 \ge m$, so the sandwich interval contains~$m$ (and~$m{+}1$), and subdivision cannot decrease the mode.

\begin{remark}[Mean shift approach]\label{rem:mean-shift}
  Let $\mu(G) = I'(G;\,1)/I(G;\,1)$ denote the mean of the normalised coefficient sequence.
  Differentiating Theorem~\ref{thm:identity} at $x = 1$ gives
  \[
    \mu(T_e) \;=\; \frac{a \cdot \mu(T) \;+\; b\bigl(1 + \mu(T/e)\bigr)}{a + b},
    \qquad a = I(T;\,1),\quad b = I(T/e;\,1),
  \]
  so $\mu(T_e)$ is a weighted average of $\mu(T)$ and $1 + \mu(T/e)$.
  In particular, $\mu(T) - \mu(T/e) < 1$ if and only if $\mu(T_e) < 1 + \mu(T/e)$.
  In the hard-core model at $\lambda = 1$, writing $A = R_{u \to v}$ and $B = R_{v \to u}$ for the cavity messages along~$e = uv$, the mean shift decomposes as
  \[
    \mu(T) - \mu(T/e)
    \;=\; \underbrace{\frac{A + B - AB}{(1+A+B)(1+AB)}}_{\textstyle\text{local} \;\in\; (0,\, 1/2)}
    \;+\; \sum_{w \ne u,v} \bigl[P_T(w) - P_{T/e}(w)\bigr].
  \]
  The local term is in $(0, 1/2)$ since $A, B \in (0, 1]$ on any tree.
  I verified $|\mu(T) - \mu(T/e)| < 0.537$ for all 3\,348\,675 edges in trees on $n \le 18$; the global maximum $|\delta\mu| \approx 0.537$ is attained by the tripod star $T(5,5,5)$ at the centre-to-bridge edge.
  For all parametric families tested (stars, double stars, extended stars, tripods), the maximum converges to~$1/2$ from above as the parameters grow.
  For a log-concave sequence with positive terms, the mode lies in $\{\lfloor\mu\rfloor, \lceil\mu\rceil\}$.
  In 864\,230 edges where $\mu(T)$ and $\mu(T/e)$ straddle an integer, I found zero instances where the modes round in opposite directions.
  Proving $|\mu(T) - \mu(T/e)| < 1$ would therefore establish ECMS for any tree with log-concave IS sequence.
\end{remark}

\begin{proposition}[Distance-1 perturbation formula]\label{prop:s1-formula}
  In the setting of Remark~\textup{\ref{rem:mean-shift}}, define the edge factors
  \[
    F_u = \frac{A(B^2 + B - 1)}{(1+A+B)(1+AB)}, \qquad
    F_v = \frac{B(A^2 + A - 1)}{(1+A+B)(1+AB)}.
  \]
  For each $w \in N(u) \setminus \{v\}$ with cavity message $q_w = R_{w \to u}$,
  \[
    P_T(w) - P_{T/e}(w) \;=\; F_u \cdot \frac{q_w}{1 + q_w},
  \]
  and symmetrically for $w \in N(v) \setminus \{u\}$ with $F_v$ and $R_{w \to v}$.
\end{proposition}

I verified this formula exactly (max error ${<}\, 2 \times 10^{-16}$) for all edges in trees on $n \le 18$.
Using $\sum_w q_w/(1+q_w) \le -\log A$ (from $\log(1+x) \ge x/(1+x)$ and $A = \prod_w (1+q_w)^{-1}$), the total distance-1 contribution satisfies $|S_1| \le |F_u|(-\log A) + |F_v|(-\log B)$; numerical optimisation over $[0,1]^2$ gives $\max |S_1| < 0.355$, well below the $1/2$ threshold.

\begin{definition}\label{def:combined_tail}
  For an edge $e$ in tree~$T$ with $\mathrm{mode}(I(T/e)) = \mathrm{mode}(I(T)) + 1$ (the \emph{gap case}), the \emph{combined tail condition} requires that $I(T_e)$ is non-increasing for all $k \ge \mathrm{mode}(I(T)) + 1$.
\end{definition}

I verified the combined tail condition for 9\,071\,864 edges in trees on $n \le 19$, finding zero violations.
The gap case arises in 8\,405 of these edges (0.09\%); in every instance the sign pattern at the two ambiguous positions is $({+},\, {-})$, confirming that the sum peaks and then descends.

\begin{theorem}[Conditional subdivision lemma]\label{thm:conditional}
  Assume ECMS (Conjecture~\ref{conj:ecms}) and the combined tail condition (Definition~\ref{def:combined_tail}).
  If $I(T)$ and $I(T/e)$ are both unimodal, then $I(T_e)$ is unimodal.
\end{theorem}

\begin{proof}
Let $M = \mathrm{mode}(I(T))$.
Define $A(x) = x \cdot I(T/e)$.
Then $I(T_e) = I(T) + A(x)$.
Let $M' = \mathrm{mode}(I(T/e))$.
The polynomial $A(x)$ has mode $M' + 1$.
Both $I(T)$ and $A(x)$ are unimodal with nonnegative coefficients.
By ECMS, $M' \in \{M{-}1, M, M{+}1\}$, so $A(x)$ has mode in $\{M, M{+}1, M{+}2\}$.

If the modes of $I(T)$ and $A(x)$ differ by at most~1, then their sum is unimodal: both summands are nondecreasing up to the earlier mode and nonincreasing from the later mode, leaving at most one position of ambiguity~-- insufficient for a valley.

In the gap case ($M' = M + 1$, mode of~$A(x)$ at $M + 2$), there are two positions~-- $k = M$ and $k = M{+}1$~-- where $I(T)$ is descending and $A(x)$ is ascending.
The combined tail condition ensures the sum is non-increasing from $M + 1$, preventing any valley.
\end{proof}

\begin{corollary}\label{cor:homirred}
  Assuming ECMS and the combined tail condition, any minimal counterexample to Conjecture~\ref{conj:main} is homeomorphically irreducible~-- it has no degree-2 vertices.
\end{corollary}

\begin{proof}
If $T$ has a degree-2 vertex~$w$ with neighbors $u$ and~$v$, then $T = T'_e$ where $T'$ is obtained by deleting~$w$ and adding edge~$uv$, and $e = uv$.
Since $T'$ has fewer vertices, it's unimodal by minimality.
Theorem~\ref{thm:conditional} then gives $I(T) = I(T'_e)$ unimodal, contradicting the assumption that $T$ is a counterexample.
\end{proof}

\begin{remark}\label{rem:additional}
  Several additional properties hold computationally.
  Through $n = 19$ (9~million edges), the polynomial $A(x)$ is always log-concave (hence unimodal).
  Through $n = 18$ (3.3~million edges), the tightest ratio $A[k{+}1]/A[k] \ge 1.125$, attained at $k = M - 1$.
  Through $n = 20$ (24.7~million edges), the product $x\, R_u R_v$ never descends before $\mathrm{mode}(I(T))$, and vertex removal shifts the mode by at most~1 ($|\mathrm{mode}(I(T)) - \mathrm{mode}(I(T{-}v))| \le 1$ for all 26~million vertex-tree pairs).
\end{remark}


\section{Reduction to \texorpdfstring{$\dleaf \le 1$}{d\_leaf â‰¤ 1} trees}\label{sec:reduction}

Write $\dleaf(v)$ for the number of leaf-children of vertex~$v$ in tree~$T$.
Call a maximal independent set~$S$ \emph{1-Private} if every $u \in S$ has at most one private neighbor (a non-$S$ vertex whose only $S$-neighbor is~$u$).
The following chain of lemmas reduces the mode bound to a single structural property.

\begin{lemma}[Private Neighbor Bound]\label{lem:pnb}
  For any tree~$T$ on $n$~vertices and any dominating independent set~$S$ of size~$k$, the total number of private vertices satisfies $P \ge n - 2k + 1$.
\end{lemma}

\begin{proof}
All edges from~$S$ go to $V \setminus S$.
Let $Q = n - k - P$ count non-$S$ vertices with $\ge 2$ $S$-neighbors.
The edge count from~$S$ satisfies $|E(S, V \setminus S)| \ge P + 2Q = 2(n - k) - P$.
Since $T$ has $n - 1$ edges, $P \ge 2(n - k) - (n - 1) = n - 2k + 1$.
\end{proof}

\begin{corollary}\label{cor:1priv-size}
  Every 1-Private maximal IS has $|S| \ge \lceil(n{+}1)/3\rceil = \lfloor n/3 \rfloor + 1$.
\end{corollary}

\begin{proof}
If $S$ is 1-Private, then $P \le k$, so $k \ge n - 2k + 1$, giving $3k \ge n + 1$.
\end{proof}

This means that if $\mathrm{mode}(I(T)) \le \lfloor n/3 \rfloor + 1$, then every 1-Private maximal IS already has $|S| \ge \mathrm{mode}$.
The remaining question is what happens when the mode exceeds this threshold.

\begin{lemma}[Hub Exclusion]\label{lem:hub}
  If $S$ is a 1-Private maximal IS and $\dleaf(v) \ge 2$, then $v \notin S$ and all leaf-children of~$v$ lie in~$S$.
\end{lemma}

\begin{proof}
If $v \in S$, each leaf-child~$w$ has $N(w) \cap S = \{v\}$, making~$w$ a private neighbor of~$v$.
Since $\dleaf(v) \ge 2$, this gives $\priv(v) \ge 2$, contradicting the 1-Private assumption.
So $v \notin S$, and each leaf-child (having only~$v$ as a neighbor) has to be in~$S$ for domination.
\end{proof}

\begin{lemma}[Transfer]\label{lem:transfer}
  Let $S$ be a 1-Private maximal IS in~$T$, and let $v$ have $\dleaf(v) = d \ge 2$ leaf-children $w_1, \dotsc, w_d$.
  Set $T' = T - \{v, w_1, \dotsc, w_d\}$.
  Then $S' = S \cap V(T')$ is a 1-Private maximal IS in~$T'$.
\end{lemma}

\begin{proof}
\emph{Maximality:}
For $u \in V(T') \setminus S'$, adding~$u$ to~$S$ in~$T$ creates a conflict with some $s \in S$.
If $s = w_i$, then $u$ is adjacent to~$w_i$, forcing $u = v$ (since $\deg(w_i) = 1$); but $v \notin V(T')$.
So $s \in S'$, and the conflict persists in~$T'$.

\emph{1-Private transfers:}
The vertex~$v$ has $d \ge 2$ neighbors in~$S$ (the leaf-children), so $v$ isn't private to any $u \in S'$.
Each~$w_i$ has $N(w_i) = \{v\}$ with $v \notin S$, so $w_i$ isn't private to any $u \in S'$ either.
Removing $\{v, w_1, \dotsc, w_d\}$ can only reduce private-neighbor counts, so $|\priv_{T'}(u)| \le |\priv_T(u)| \le 1$.
\end{proof}

Applying Hub Exclusion iteratively~-- removing each vertex~$v$ with $\dleaf(v) \ge 2$ together with its leaf-children~-- terminates at a residual forest where every vertex has $\dleaf \le 1$.
The Transfer Lemma ensures that the 1-Private condition propagates to each component.
By Corollary~\ref{cor:1priv-size} applied to each component, $|S'| \ge \sum_j \lceil(|C_j| + 1)/3\rceil$, where $C_j$ are the components.

The mode bound for all trees thus reduces to Conjecture~A below: if every $\dleaf \le 1$ tree has mode at most $\lfloor n/3 \rfloor + 1$, then the forced leaves and residual-component bounds together control the mode for trees with $\dleaf \ge 2$ as well.
(This constrains the mode position; it does not by itself prove unimodality.)

\begin{conjecture}[Conjecture A]\label{conj:A}
  If every vertex of a tree~$T$ on~$n$ vertices has $\dleaf(v) \le 1$, then $\mathrm{mode}(I(T)) \le \lfloor n/3 \rfloor + 1$.
\end{conjecture}

I verified Conjecture~A for all 931\,596 trees with $\dleaf \le 1$ through $n = 23$ (zero violations).
The complementary Case~B bound~-- that every tree with some $\dleaf \ge 2$ has the mode controlled by the forced leaves and residual components~-- was verified for 8\,710\,881 trees through $n = 22$ (zero violations, minimum surplus~1).

\subsection{The mean bound}\label{subsec:mean}

Conjecture~A can be approached through the hard-core model.
At fugacity $\lambda = 1$, each IS is equally likely.
Write $P(v)$ for the probability that vertex~$v$ belongs to a uniformly random IS (the scalar occupation probability, not the polynomial~$P_v(x)$ of Section~\ref{sec:method}).
The expected IS size is $\mu = \sum_v P(v)$.
Since $I(T;\, 1)$ counts all IS and $I'(T;\, 1) = \sum_k k\, i_k$, we have $\mu = I'(T;\, 1) / I(T;\, 1)$.

All $\dleaf \le 1$ trees tested through $n = 23$ (931\,596 trees) have log-concave independence sequences.
For a log-concave sequence of positive terms, the ratios $a_{k+1}/a_k$ are non-increasing, so the mode and mean lie within~1 of each other; in particular, $\mathrm{mode} \le \lceil \mu \rceil$.
Since $\lceil \mu \rceil \le \lfloor n/3 \rfloor + 1$ whenever $\mu < n/3$, Conjecture~A would follow from log-concavity of $\dleaf \le 1$ IS polynomials together with $\mu < n/3$.
The latter is proved in Corollary~\ref{cor:mu-bound} below via the Steiner peeling method.

\begin{remark}
The mode-mean bound $\mathrm{mode}(I(T)) \le \lceil \mu(T) \rceil$ holds for all 931\,596 $\dleaf \le 1$ trees through $n = 23$ (zero violations), and for all 205\,002 trees (of any type) through $n = 18$, including both log-concavity-failing trees at $n = 26$ (where $\mu \approx 7.83$ and $\mathrm{mode} = 8$).
Log-concavity suffices to prove this bound classically, but the bound appears to hold universally regardless of log-concavity.
If this mode-mean bound could be proved directly for $\dleaf \le 1$ trees, Conjecture~A would follow from Corollary~\ref{cor:mu-bound} without requiring log-concavity.

The stronger Darroch conclusion $\mathrm{mode} \in \{\lfloor\mu\rfloor, \lceil\mu\rceil\}$ -- which log-concavity implies classically -- also holds for all 175\,722 $\dleaf \le 1$ trees through $n = 21$; of these, 69.65\,\% have $\mathrm{mode} = \lfloor\mu\rfloor$ and 30.35\,\% have $\mathrm{mode} = \lceil\mu\rceil$.
This mode-localisation is as tight as Darroch's theorem predicts from log-concavity, appearing to hold here without log-concavity being established.
\end{remark}

\begin{remark}[Tie-fugacity condition]
A sharpened proof target avoids log-concavity entirely.
For a tree~$T$ with IS polynomial $I(x) = \sum_k i_k x^k$ and mode $m$ at fugacity~$1$, define the \emph{tie fugacity} $\lambda_m = i_{m-1}/i_m$.
At fugacity~$\lambda_m$, IS of sizes $m-1$ and~$m$ have equal probability weight $i_{m-1}\lambda_m^{m-1} = i_m\lambda_m^m$, and every other size has strictly smaller weight (verified for all 11\,172\,104 adjacent pairs across 931\,596 trees).
Since $m$ is the mode at fugacity~1, we have $i_m \ge i_{m-1}$, so $\lambda_m \le 1$.
The expected IS size $\mu(\lambda) = \sum_v P(v;\lambda)$ is strictly increasing in~$\lambda$, so $\mu(\lambda_m) \le \mu(1) = \mu(T)$.

If one could prove the single-tie condition $\mu(\lambda_m) \ge m - 1$, then
\[
  m - 1 \;\le\; \mu(\lambda_m) \;\le\; \mu(T) \;<\; \frac{n}{3}
\]
(the last inequality by Corollary~\ref{cor:mu-bound}), giving $\mathrm{mode} = m \le \mu(T) + 1 < n/3 + 1$, and hence $\mathrm{mode} \le \lfloor n/3 \rfloor + 1$~-- Conjecture~A~-- with no log-concavity required.
This condition holds for all 931\,596 $\dleaf \le 1$ trees through $n = 23$, with minimum margin $\mu(\lambda_m) - (m-1) \ge 0.362$.
\end{remark}

The minimum margin is attained by $S(2^{10})$, the equal-arm spider with hub connected to ten arms of length~2 (21~vertices, $\dleaf = 1$ everywhere).
More generally, the margin for the $S(2^k)$ family can be bounded analytically.

\begin{proposition}[Equal-arm spider tie-fugacity margin]\label{prop:spider-tie-margin}
  For the equal-arm spider $S(2^k)$ on $n = 2k+1$ vertices, with hub $h$ connected to $k$ arms of length~$2$:
  \begin{enumerate}
    \item $I(S(2^k);\, x) = x(1+x)^k + (1+2x)^k$, with $i_j = \tbinom{k}{j-1} + 2^j\tbinom{k}{j}$.
    \item The mode is $m = \lfloor(2k+1)/3\rfloor$ for all $k \ge 3$.
    \item The hub-off mean at the tie fugacity $\lambda_m$ exceeds $m-1$: $kq_m > m-1$ where $q_m = 2\lambda_m/(1+2\lambda_m)$.
    \item The tie-fugacity margin satisfies $\mu(\lambda_m) - (m-1) > 1/3 - k(2/3)^k/3 > 0$, and
          $\mu(\lambda_m) - (m-1) \to 1/3$ as $k \to \infty$.
  \end{enumerate}
\end{proposition}

\begin{proof}
\textit{Part~1.}
At fugacity~$\lambda$, the IS distribution is a mixture of two components depending on whether the hub is included:
\begin{itemize}
  \item \emph{Hub-on} (weight $\lambda(1+\lambda)^k$): hub included, each arm contributes its leaf or nothing, IS size $= 1 + \operatorname{Bin}(k,\, \lambda/(1+\lambda))$.
  \item \emph{Hub-off} (weight $(1+2\lambda)^k$): hub excluded, each arm independently includes its elbow, its leaf, or nothing, IS size $= \operatorname{Bin}(k,\, 2\lambda/(1+2\lambda))$.
\end{itemize}
Summing over IS by size gives $I(x) = x(1+x)^k + (1+2x)^k$, and expanding the coefficients gives $i_j = \tbinom{k}{j-1} + 2^j\tbinom{k}{j}$.

\textit{Part~2.}
The dominant term $2^j\tbinom{k}{j}$ has the ratio $2^{j+1}\tbinom{k}{j+1}/[2^j\tbinom{k}{j}] = 2(k-j)/(j+1)$, which exceeds~1 iff $j < (2k-1)/3$.
The full ratio $i_{j+1}/i_j$ exceeds~1 below the mode and is at most~1 at the mode; the sub-dominant terms $\tbinom{k}{j-1}$ shift the threshold by less than one unit, placing the mode at $m = \lfloor(2k+1)/3\rfloor$.

\textit{Part~3.}
The condition $kq_m > m-1$ is equivalent to $\lambda_m > (m-1)/[2(k-m+1)]$.
For $k = 3j+1$ and $m = 2j+1$, the right-hand side is $j/(j+1)$.
The dominant-term approximation gives $\lambda_m \approx 2^{m-1}\tbinom{k}{m-1}/[2^m\tbinom{k}{m}] = m/[2(k-m+1)] = (2j+1)/[2(j+1)]$, which exceeds $j/(j+1)$ by $1/[2(j+1)] > 0$.
The sub-dominant correction to~$\lambda_m$ is positive for $j \ge 2$, so $\lambda_m > (2j+1)/[2(j+1)] > j/(j+1)$, and $kq_m > m-1$.
The cases $k \equiv 0, 2 \pmod{3}$ follow by the same calculation with $m = \lfloor(2k+1)/3\rfloor$ in each case.

\textit{Part~4.}
Writing $p_0 = \lambda_m(1+\lambda_m)^k/Z$ and $p_1 = 1-p_0$ for the hub-on and hub-off weights:
\[
  \mu(\lambda_m) - (m-1)
  = \underbrace{(kq_m - (m-1))}_{\text{hub-off surplus}}
  - p_0\underbrace{(kq_m - 1 - kp_m)}_{\text{hub gap}},
\]
where $p_m = \lambda_m/(1+\lambda_m)$.
For the hub-off surplus: expanding $kq_m$ at $\lambda_m \ge (2j+1)/(2j+2)$ gives $kq_m \ge (3j+1)(2j+1)/(3j+2) = (m-1) + (j+1)/(3j+2)$.
The bound $(j+1)/(3j+2) \ge 1/3$ holds since $(j+1)/(3j+2) - 1/3 = 1/(3(3j+2)) > 0$.
For the hub gap: $kq_m - 1 - kp_m = k\lambda_m/[(1+\lambda_m)(1+2\lambda_m)] - 1$; since $\lambda/[(1+\lambda)(1+2\lambda)] < 1/3$ for all $\lambda > 0$ (as $3\lambda < 1 + 3\lambda + 2\lambda^2$), the hub gap satisfies $kq_m - 1 - kp_m < k/3$.
For the hub-on weight: $(1+2\lambda_m)/(1+\lambda_m) > 1$ for all $\lambda_m > 0$, so $p_0 \to 0$ geometrically.
When hub gap $\le 0$ (which holds for $k \le 5$, computed from the dominant-term formula), the correction $p_0 \cdot \text{hub gap} \le 0$ and margin $\ge 1/3 > 0$.
For $6 \le k \le 11$ ($n = 2k+1 \le 23$, within the exhaustive scan): margin $> 0$ holds by direct computation.
For $k \ge 12$: the dominant-term formula gives $\lambda_m \ge 2/3$ in all three residue classes, so $(1+\lambda_m)/(1+2\lambda_m) \le 5/7$ and $p_0 \le (5/7)^k$; then $p_0 \cdot \text{hub gap} \le k(5/7)^k/3$, which is at most $4(5/7)^{12} \approx 0.071 < 1/3$ at $k = 12$ and decreasing for all larger~$k$, giving margin $> 0$.
As $k \to \infty$ along $k = 3j+1$, the hub-off surplus $(j+1)/(3j+2) \to 1/3$ and $p_0 \cdot \text{hub gap} \to 0$ exponentially, so the margin converges to $1/3$ from above.
\end{proof}

\begin{remark}
The proof above establishes margin $> 0$ but does not show margin $> 1/3$ directly.
Numerically, margin $> 1/3$ for all $k \le 600$, with margin $= 1/3 + c/k + O(1/k^2)$ and $c \approx 1/3$; a closed-form proof of the sharper bound would follow from the exact asymptotics of~$\lambda_m$.
Since $S(2^k)$ is the extremal $\dleaf \le 1$ tree for the mean bound (verified through $n \le 20$), establishing that the same extremality holds for the tie-fugacity margin would reduce the full tie-fugacity condition $\mu(\lambda_m) \ge m-1$ to the spider case, which Proposition~\ref{prop:spider-tie-margin} already proves.
\end{remark}

I verified $\mu < n/3$ for all 931\,596 such trees through $n = 23$; the worst ratio is $\mu / (n/3) = 0.973$.
The extremal family consists of \emph{spiders}~-- trees with exactly one vertex of degree $\ge 3$ (the hub) and paths radiating from it.
The notation $S(a_1, \dotsc, a_m)$ denotes the spider whose $m$~arms have lengths $a_1, \dotsc, a_m$.
The worst case is $S(2^k, 1)$ (a hub with $k$ arms of length~2 and one pendant leaf).

\begin{proposition}\label{prop:spider-mean}
  For the spider $S(2^k, 1)$ on $n = 2k + 2$ vertices,
  \[
    \frac{n}{3} - \mu \;=\; \frac{3^k + 2^{k-1}(k-2)}{3(2 \cdot 3^k + 2^k)} \;\longrightarrow\; \frac{1}{6}
    \quad\text{as } k \to \infty.
  \]
  In particular, $\mu < n/3$ for all $k \ge 1$.
\end{proposition}

\begin{proof}
The IS polynomial is $I(x) = (1+x)(1+2x)^k + x(1+x)^k$, giving $I(1) = 2 \cdot 3^k + 2^k$ and $I'(1) = 3^k + 4k \cdot 3^{k-1} + 2^k + k \cdot 2^{k-1}$.
The gap $n/3 - \mu$ simplifies to the stated expression.
The numerator is positive for $k \ge 3$; direct computation confirms $k = 1, 2$.
\end{proof}

The hard-core model~-- the uniform distribution over IS of a graph, studied extensively in statistical physics and combinatorics (see \textcite{galvin2025} for a survey in the tree setting)~-- provides structural insight into why $\mu < n/3$ should hold.

\begin{theorem}[Edge bound]\label{thm:edge-bound}
  For any tree~$T$ on $n \ge 3$ vertices and any edge $e = uv$, the hard-core occupation probabilities satisfy $P(u) + P(v) < 2/3$.
\end{theorem}

\begin{proof}
Remove~$e$ to obtain components $T_u$ and~$T_v$.
The number of IS excluding both endpoints is $N_0 = R_u(1)\, R_v(1)$, and the total is $N = R_u(1)\, R_v(1) + P_u(1)\, R_v(1) + R_u(1)\, P_v(1)$.
Writing $r_u = P_u(1)/R_u(1)$ and $r_v = P_v(1)/R_v(1)$:
\[
  P(u) + P(v) = 1 - \frac{N_0}{N} = \frac{r_u + r_v}{1 + r_u + r_v}.
\]
Now $r_v = 1$ if and only if $v$ is a leaf of~$T$ (since $r_v = \prod_{c} 1/(1 + r_c)$, which equals~1 only for the empty product).
For $n \ge 3$, at least one of $u, v$ has a neighbor besides the other, so at least one ratio is strictly less than~1.
Both ratios are at most~1, giving $r_u + r_v < 2$ and $P(u) + P(v) < 2/3$.
\end{proof}

The edge bound implies that the set $\{v : P(v) > 1/3\}$ is independent (two adjacent vertices can't both exceed $1/3$).
For $\dleaf \le 1$ trees, every support vertex~$v$ (having a leaf-child~$w$) satisfies $r_v \le 1/2$ (the leaf contributes a factor $1/(1+1) = 1/2$ in the cavity recursion $r_v = \prod_c 1/(1+r_c)$), so $P(v) + P(w) \le 2/3$ by the edge bound.
Pairing each leaf~$w$ with its support vertex~$v$, these $2\ell$ vertices (where $\ell$ is the number of leaves) contribute at most $2\ell/3$ to $\mu$.
For the global bound $\mu < n/3$ to hold, the remaining $n - 2\ell$ interior vertices must contribute less than $(n - 2\ell)/3$.
Their occupation probabilities tend toward the infinite-path limit $P \approx 0.276 < 1/3$.
A proof of the global bound $\mu < n/3$ is given in Corollary~\ref{cor:mu-bound} below using a Steiner peeling argument on the heavy-vertex compensation function.

The bound can be reformulated as a compensation condition.
Since $H$ is independent and every $v \notin H$ has $P(v) \le 1/3$,
\[
  \mu
  = \sum_{h \in H}\! P(h) + \sum_{u \in N(H)}\! P(u) + \sum_{w \notin H \cup N(H)}\! P(w)
  \;\le\; \frac{n}{3} + \sum_{h \in H}\!\bigl(P(h) - \tfrac{1}{3}\bigr) - \sum_{u \in N(H)}\!\bigl(\tfrac{1}{3} - P(u)\bigr),
\]
so $\mu \le n/3$ whenever the heavy surplus is absorbed by the neighbourhood deficit:
\begin{equation}\label{eq:whnc}
  \sum_{h \in H}\!\bigl(P(h) - \tfrac{1}{3}\bigr)
  \;\le\;
  \sum_{u \in N(H)}\!\bigl(\tfrac{1}{3} - P(u)\bigr).
\end{equation}

\begin{proposition}[Singleton compensation]\label{prop:singleton}
  For each $h \in H$,
  \[
    \sum_{u \in N(h)}\!\bigl(\tfrac{1}{3} - P(u)\bigr) \;>\; P(h) - \tfrac{1}{3}.
  \]
\end{proposition}

\begin{proof}
Each $u \in N(h)$ satisfies $P(u) < 2/3 - P(h) < 1/3$ by the edge bound, so every summand exceeds $P(h) - 1/3$.
\end{proof}

The case with a single non-leaf heavy vertex is also provable.

\begin{proposition}[Mixed single-hub compensation]\label{prop:mixed-single}
  In any $\dleaf \le 1$ tree, let $L \ne \emptyset$ be a set of heavy leaves and $h \in H$ a non-leaf heavy vertex.
  Then $F(L \cup \{h\}) > 0$.
\end{proposition}

\begin{proof}
Write $s_l$ for the (unique) support of leaf~$l$, set $A_l = 2/3 - P(s_l) - P(l) > 0$ (edge bound on $l$--$s_l$), and let $J = N(h) \setminus \{s_l : l \in L\}$.
The $\dleaf \le 1$ condition gives distinct supports, and
\[
  F(L \cup \{h\}) = \sum_{l \in L} A_l + \sum_{j \in J}\bigl(\tfrac{1}{3} - P(j)\bigr) - \bigl(P(h) - \tfrac{1}{3}\bigr).
\]

\textit{Case~1: $J \ne \emptyset$.}
Any $j \in J$ satisfies $P(h) + P(j) < 2/3$ (edge bound on $h$--$j$), so $\tfrac{1}{3} - P(j) > P(h) - \tfrac{1}{3}$.
The $J$-supply alone exceeds the $h$-demand, giving $F > \sum_l A_l \ge 0$.

\textit{Case~2: $J = \emptyset$.}
Let $L_I = \{l \in L : s_l \in N(h)\}$; leaves in $L \setminus L_I$ contribute only non-negative $A_l$ terms.
Since $J = \emptyset$, we have $N(h) = \{s_i\}_{i=1}^m$ where $m = \deg(h) \ge 2$.
Write $q_i = R_{s_i \to h}$; the leaf child $l_i$ forces $q_i \le 1/2$.
Set $Q = \prod_i(1+q_i)$ and $Y = Q+1$; the cavity formulas give
\[
  P(h) = \frac{1}{Y}, \qquad P(s_i) = \frac{q_i Q}{Y(1+q_i)}, \qquad P(l_i) = \frac{Q+1+q_i}{2Y(1+q_i)}.
\]
Direct expansion yields
\[
  F_I := \sum_{i=1}^m A_i - \bigl(P(h) - \tfrac{1}{3}\bigr) = \frac{m+2}{6} - \frac{1}{Y} - \frac{Q}{2Y}\sum_{i=1}^m \frac{q_i}{1+q_i}.
\]
Since $q_i \le 1/2$, we have $q_i/(1+q_i) \le 1/3$, so $F_I \ge (m+2)/6 - (6+Qm)/(6Y)$, which is positive iff $2Q + m > 4$.
For $m = 2$: $Q > 1$ since $q_i > 0$ strictly.
For $m \ge 3$: $2Q + m \ge 2 + 3 = 5 > 4$.
Hence $F_I > 0$, and $F(L \cup \{h\}) \ge F_I > 0$.
\end{proof}

Condition~\eqref{eq:whnc} is a weighted analogue of Hall's marriage condition: the probability deficit in $N(S)$ must cover the surplus from every subset $S \subseteq H$, not just singletons.
I verified~\eqref{eq:whnc} for all 931\,596 trees with $\dleaf \le 1$ through $n = 23$ (zero violations).

The $\dleaf \le 1$ structure enables a decimation reduction that resolves the global compensation problem.

\begin{lemma}[Decimation identity]\label{lem:decimation}
For any $\dleaf \le 1$ tree~$T$ with leaves $L$, support vertices $A$ (those adjacent to leaves), and core $C = V \setminus L$,
\[
  \frac{n}{3} - \mu(T)
  = \sum_{v \in C \setminus A}\!\Bigl(\frac{1}{3} - P(v)\Bigr)
  + \frac{1}{2}\sum_{v \in A}\!\Bigl(\frac{1}{3} - P(v)\Bigr).
\]
Every support vertex satisfies $P(v) < 1/3$, so every heavy vertex lies in $H_{\mathrm{core}} := \{v \in C \setminus A : P(v) > 1/3\}$.
\end{lemma}

\begin{proof}
Each support $s \in A$ has exactly one leaf child $l_s$ (since $\dleaf \le 1$), with $P(l_s) = (1 - P(s))/2$ by the cavity recursion.
Summing over all vertices and using $n = 2|A| + |C \setminus A|$ gives the identity.
The support bound holds because the leaf forces the factor $1/(1+1) = 1/2$ in $R_{s \to h} = \prod_{c \ne h} 1/(1 + R_{c \to s})$, so $R_{s \to h} \le 1/2$; the edge bound then gives $P(s) < 1/3$.
\end{proof}

Since the identity decomposes $n/3 - \mu$ as a sum of non-negative terms over all $C$-vertices, with the heavy interior vertices contributing negative terms, the global gap is bounded below by the \emph{gap-formula surplus}:
\[
  F_{\mathrm{gap}}(S)
  = \sum_{u \in N_C(S) \cap C \setminus A}\!\!\!\Bigl(\frac{1}{3} - P(u)\Bigr)
  + \frac{1}{2}\!\!\sum_{u \in N_C(S) \cap A}\!\!\Bigl(\frac{1}{3} - P(u)\Bigr)
  - \sum_{h \in S}\!\Bigl(P(h) - \frac{1}{3}\Bigr),
\]
where $N_C(S) = N(S) \cap (C \setminus S)$.
Vertices in $C \setminus (H_{\mathrm{core}} \cup N_C(H_{\mathrm{core}}))$ have $P \le 1/3$ and contribute non-negatively to the identity, so $n/3 - \mu(T) \ge F_{\mathrm{gap}}(H_{\mathrm{core}})$.

\begin{theorem}[Gap-formula compensation by Steiner peeling]\label{thm:steiner-peeling}
For any $\dleaf \le 1$ tree~$T$ and every non-empty $S \subseteq H_{\mathrm{core}}$, $F_{\mathrm{gap}}(S) > 0$.
\end{theorem}

\begin{proof}
Induction on $|S|$.
Write $s(u) = 1/3 - P(u)$ for $u \in C \setminus A$ and $s(u) = \tfrac{1}{2}(1/3 - P(u))$ for $u \in A$.

\textit{Base case} $S = \{h\}$.
All $m = \deg_T(h) \ge 2$ neighbours $u_1, \ldots, u_m$ of $h$ are in $C$ (since $h \in H_{\mathrm{core}} \subset C \setminus A$) and are private.
$F_{\mathrm{gap}}(\{h\}) = \sum_i s(u_i) - (P(h) - 1/3)$.

If any $u_i \in C \setminus A$: the edge bound gives $s(u_i) - (P(h) - 1/3) = 2/3 - P(h) - P(u_i) > 0$, so $F_{\mathrm{gap}}(\{h\}) > 0$.

If all $u_i \in A$, we show $2P(h) + \sum P(u_i) < (m+2)/3$, which is equivalent to $F_{\mathrm{gap}}(\{h\}) > 0$:
\begin{itemize}
  \item $m = 2$: summing the two edge bounds $P(h) + P(u_i) < 2/3$ gives $2P(h) + P(u_1) + P(u_2) < 4/3$.
  \item $m \ge 3$: summing $m$ edge bounds gives $m P(h) + \sum P(u_i) < 2m/3$; subtracting $(m-2)P(h) > (m-2)/3$ yields $2P(h) + \sum P(u_i) < (m+2)/3$.
\end{itemize}

\textit{Inductive step} $|S| \ge 2$.
Let $h$ be a leaf of the Steiner tree of $S$ in $T$ (minimal subtree spanning $S$).
Then $h$ has $k = \deg_T(h) - 1 \ge 1$ private $C$-neighbours $u_1, \ldots, u_k$ and one non-private neighbour $v_0$.
The removal marginal is $M_{\mathrm{gap}}(h, S) = \sum_i s(u_i) - (P(h) - 1/3)$.

If any $u_i \in C \setminus A$: the edge bound gives $M_{\mathrm{gap}} \ge 2/3 - P(h) - P(u_i) > 0$.

If all $u_i \in A$, the same counting argument as the base case shows $M_{\mathrm{gap}} > 0$ for $k \ge 2$.
For $k = 1$ (so $\deg_T(h) = 2$, with sole private $A$-neighbour $u_1$ and non-private $v_0$), the belief-propagation fixed-point equations give
\[
  P(h) = \frac{1}{D}, \qquad P(u_1) = \frac{(1 + \alpha)a}{D}, \qquad D = 2 + a + \alpha + a\alpha,
\]
where $a = R_{u_1 \to h} \le 1/2$ (leaf-suppression at $u_1$) and $\alpha = R_{v_0 \to h} > 0$ (strictly positive at $\lambda = 1$).
Then $2P(h) + P(u_1) = (2 + a + a\alpha)/D = 1 - \alpha/D < 1$, so $M_{\mathrm{gap}} = (1 - 2P(h) - P(u_1))/2 > 0$.

In every case $M_{\mathrm{gap}}(h, S) > 0$, so $F_{\mathrm{gap}}(S) = F_{\mathrm{gap}}(S \setminus \{h\}) + M_{\mathrm{gap}}(h, S) > F_{\mathrm{gap}}(S \setminus \{h\}) > 0$ by induction.
\end{proof}

\begin{corollary}\label{cor:mu-bound}
For every $\dleaf \le 1$ tree~$T$, $\mu(T) < n/3$.
\end{corollary}

\begin{proof}
If $H_{\mathrm{core}} = \emptyset$, all terms in Lemma~\ref{lem:decimation} are positive ($P(v) \le 1/3$ throughout $C$, strictly so in $A$), giving $n/3 - \mu > 0$.
If $H_{\mathrm{core}} \ne \emptyset$, Theorem~\ref{thm:steiner-peeling} gives $F_{\mathrm{gap}}(H_{\mathrm{core}}) > 0$, and $n/3 - \mu \ge F_{\mathrm{gap}}(H_{\mathrm{core}}) > 0$.
\end{proof}


\section{Exhaustive verification through \texorpdfstring{$n = 27$}{n = 27}}\label{sec:exhaustive}

Table~\ref{tab:exhaustive} shows the verification results.
Every tree count matches OEIS A000055 \citep{oeis-a000055}; counts are checked automatically during the search.
No unimodality violation was found at any~$n$.

\begin{table}[ht]
  \centering
  \caption{Exhaustive verification of unimodality for trees on $n$ vertices.  Times are for an Apple Silicon Mac with 8 parallel workers ($n \le 26$) or Modal cloud compute with 1024 workers ($n = 27$).}
  \label{tab:exhaustive}
  \begin{tabular}{r r r}
    \toprule
    $n$ & Trees & Time \\
    \midrule
    1--15 & \liningnums{13\,188} & ${<}\,1$\,s \\
    16 & \liningnums{19\,320} & 1\,s \\
    17 & \liningnums{48\,629} & 3\,s \\
    18 & \liningnums{123\,867} & 9\,s \\
    19 & \liningnums{317\,955} & 23\,s \\
    20 & \liningnums{823\,065} & 68\,s \\
    21 & \liningnums{2\,144\,505} & 55\,s \\
    22 & \liningnums{5\,623\,756} & 1\,m\,44\,s \\
    23 & \liningnums{14\,828\,074} & 4\,m\,41\,s \\
    24 & \liningnums{39\,299\,897} & 12\,m\,5\,s \\
    25 & \liningnums{104\,636\,890} & 38\,m\,33\,s \\
    26 & \liningnums{279\,793\,450} & 4\,h\,51\,m \\
    27 & \liningnums{751\,065\,460} & 1\,h\,18\,m \\
    \midrule
    Total & \liningnums{1\,198\,738\,056} & \\
    \bottomrule
  \end{tabular}
\end{table}

The case $n = 26$ is the first at which log-concavity fails: \textcite{kadrawi2023} found exactly two failures through exhaustive enumeration, implicitly confirming unimodality at every~$n$ up to~26.
My independent re-analysis reproduces these two failures (both at $k = 13$, worst ratio $i_{12}\, i_{14} / i_{13}^2 = 1.145$) and adds the near-miss metric: $\nm = 0.845$~-- far below the violation threshold.
Even where log-concavity breaks, unimodality holds with a comfortable margin.
Extending to $n = 27$ (751~million trees, run on Modal cloud compute with 1024 parallel workers) finds no unimodality violations, bringing the total to nearly 1.2~billion trees checked.
Figure~\ref{fig:roots26} plots the roots of the independence polynomials of these two trees in the complex plane; neither polynomial is real-rooted.

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{figures/roots_n26_lc_failures.pdf}
  \caption{Roots of the independence polynomials of the two LC-failing trees at $n = 26$.  All 12 displayed roots lie inside the unit circle; each tree also has a conjugate pair with modulus $\approx 52$ and~$45$, respectively (not shown).  Neither polynomial is real-rooted.}
  \label{fig:roots26}
\end{figure}

Beyond exhaustive enumeration, I tested 145\,362 trees from five structured families (subdivided stars, caterpillars, spiders, brooms, and random perturbations) at sizes up to $n = 500$, finding zero unimodality violations and 378 log-concavity failures (all but 2 in subdivided stars).
The highest near-miss ratio among these families is $\nm = 0.992$ (spiders and brooms), but brooms aren't the true extremal family.


\section{Extremal families and asymptotics}\label{sec:extremal}

To search for trees that maximize~$\nm$, I ran an evolutionary optimizer over tree space using mutations (leaf relocation, subtree prune-and-regraft, pendant concentration) with elite selection.
The optimizer consistently converged to a generalization of brooms.

\begin{definition}[Multi-arm star]\label{def:multiarm}
  For integers $s \ge 0$ and $k \ge 1$ with arm lengths $a_1 \ge \cdots \ge a_k \ge 1$, the \emph{multi-arm star} $M(s;\, a_1, \dotsc, a_k)$ has a central hub with $s$~pendant leaves and $k$~paths of the given lengths.
  A standard broom $\broom(p,s)$ is the special case $M(s;\, p{-}1)$.
\end{definition}

Table~\ref{tab:multiarm} compares the best standard broom against the best multi-arm star at each vertex count.
Multi-arm stars achieve higher~$\nm$ at every~$n$ tested, with the optimal configuration transitioning from two arms at small~$n$ to four arms by $n = 200$.
The champion at $n \ge 200$ is $M(s;\, 5, 5, 4, 2)$, achieving $\nm = 0.9918$ at $n = 500$.

\begin{table}[ht]
  \centering
  \caption{Best standard broom vs.\ best multi-arm star at each~$n$.
    All values are near-miss ratios (higher is closer to violation); the multi-arm star exceeds the broom at every~$n$ at full precision.}
  \label{tab:multiarm}
  \begin{tabular}{r l l l}
    \toprule
    $n$ & Best broom $\nm$ & Best multi-arm $\nm$ & Configuration \\
    \midrule
    75   & 0.9412 & 0.9437 & 2-arm$(6,2)$ \\
    100  & 0.9551 & 0.9575 & 3-arm$(6,3,2)$ \\
    200  & 0.9779 & 0.9792 & 4-arm$(5,5,4,2)$ \\
    500  & 0.9917 & 0.9918 & 4-arm$(5,5,4,2)$ \\
    1000 & 0.9959 & 0.9959 & 4-arm$(5,5,4,2)$ \\
    \bottomrule
  \end{tabular}
\end{table}

The asymptotic mechanism behind these near-misses applies to any fixed core with pendant leaves.

\begin{theorem}[Leaf-attachment asymptotics]\label{thm:leaf-attach}
Let $H$ be a fixed tree with distinguished vertex~$v$, and let $H_s$ be obtained by attaching $s$~new leaves to~$v$.
Write $A(x) = I(H - v;\, x)$ with $\mu_A = A'(1)/A(1)$ and $m = \lceil \mu_A + \tfrac{1}{2} \rceil$.
Then
\[
  \nm(s) \;=\; 1 - \frac{C}{s} + O\!\left(\frac{1}{s^2}\right),
  \quad C = (4m + 2) - 4\mu_A.
\]
In particular, $C \in [4, 8)$, so $H_s$ is unimodal for all sufficiently large~$s$.
\end{theorem}

\begin{proof}
Write $I(H_s;\, x) = (1+x)^s A(x) + x\, B(x)$ where $B(x) = I(H - N[v];\, x)$.
Let $c_k = [x^k]\, I(H_s)$ and $d_k = \sum_j a_j \binom{s}{k-j}$ be the leading contribution.
For $k = s/2 + y$ with $y = O(1)$, the ratio $\binom{s}{k{+}1{-}j}/\binom{s}{k{-}j} = 1 - (4y + 2 - 4j)/s + O(1/s^2)$.
Taking the $a_j$-weighted average:
\[
  \frac{d_{k+1}}{d_k} = 1 - \frac{4y + 2 - 4\mu_A}{s} + O(1/s^2).
\]
The $x B(x)$ term contributes $O(\sqrt{s}\, 2^{-s})$ relative to~$d_k$ in the central window (since $B$ is a fixed polynomial while $d_k$ grows as~$2^s/\sqrt{s}$), so $c_{k+1}/c_k = d_{k+1}/d_k + O(\sqrt{s}\, 2^{-s})$.
The first descent occurs at $y_0 \approx \mu_A - 1/2$.
The near-miss ratio is maximized at the first integer past the descent, giving $C = (4m + 2) - 4\mu_A$ with $m - (\mu_A + 1/2) \in [0, 1)$, so $C \in [4, 8)$.
\end{proof}

Table~\ref{tab:Cpred} compares the predicted~$C(p)$ against the empirical value at $s = 5{,}000$ for brooms $\broom(p, s)$, using $\mu_A = G_{p-1}/F_{p-1}$ where $F_n, G_n$ satisfy the Fibonacci-type recurrences $F_n = F_{n-1} + F_{n-2}$ and $G_n = G_{n-1} + G_{n-2} + F_{n-2}$.
Agreement is within 0.5\% in all cases.

\begin{table}[ht]
  \centering
  \caption{Predicted vs.\ observed scaling constant $C(p)$ for broom $\broom(p, s)$.}
  \label{tab:Cpred}
  \begin{tabular}{r r r l l l}
    \toprule
    $p$ & $F_{p-1}$ & $G_{p-1}$ & $\mu_A$ & $C_{\mathrm{pred}}$ & $C_{\mathrm{obs}}$ \\
    \midrule
    13 & \liningnums{377} & \liningnums{1\,308} & 3.469 & 4.122 & 4.115 \\
    22 & \liningnums{28\,657} & \liningnums{170\,711} & 5.957 & 6.172 & 6.156 \\
    33 & \liningnums{5\,702\,887} & \liningnums{51\,310\,978} & 8.997 & 6.011 & 5.991 \\
    42 & \liningnums{433\,494\,437} & \liningnums{4\,978\,643\,596} & 11.485 & 4.060 & 4.045 \\
    50 & \liningnums{20\,365\,011\,074} & \liningnums{278\,920\,277\,425} & 13.696 & 7.216 & 7.182 \\
    \bottomrule
  \end{tabular}
\end{table}

The multi-arm star champion $M(s;\, 5, 5, 4, 2)$ has an empirical rate $\hat{C} \approx 3.98$ at the tested range (a finite-$s$ estimate that absorbs the $O(1/s^2)$ remainder); the theorem guarantees the asymptotic value $C \ge 4$ for any fixed core, so the margin is positive for all sufficiently large~$s$.


\section{Discussion}\label{sec:discussion}

Two independent lines of argument constrain the structure of any counterexample.
The subdivision-contraction identity (Theorem~\ref{thm:identity}) provides algebraic structure: the relationship $I(T_e) = I(T) + x \cdot I(T/e)$ connects three natural operations on trees.
If ECMS (Conjecture~\ref{conj:ecms}) and the combined tail condition hold, subdivision preserves unimodality, so any minimal counterexample has no degree-2 vertices.
The PNP reduction (Section~\ref{sec:reduction}) provides combinatorial structure: Hub Exclusion and Transfer force the behavior of large IS on trees with many leaf-children, reducing the mode bound to Conjecture~A about $\dleaf \le 1$ trees.

These two threads don't yet close the problem.
ECMS and Conjecture~A remain open, and neither immediately implies the other.
But they point toward complementary proof strategies: ECMS would be established by understanding how edge contraction affects the mode (a local operation), while Conjecture~A requires bounding the mean IS size (a global property related to the hard-core model).

The hard-core model connection is worth highlighting.
The edge bound $P(u) + P(v) < 2/3$ (Theorem~\ref{thm:edge-bound}) is tight for $K_2$ and already constrains the mean.
For $\dleaf \le 1$ trees, the leaf-support pairing accounts for all but the interior vertices, whose occupation probabilities tend to be well below $1/3$.
A proof that $\sum_v P(v) < n/3$ would settle Conjecture~A.

Two main open problems remain.
First, prove ECMS.
The mean shift approach (Remark~\ref{rem:mean-shift}) reduces this to showing $|\mu(T) - \mu(T/e)| < 1$, with the local component of the shift proved to lie in $(0, 1/2)$.
The remaining remote component decays geometrically with distance from the contracted edge at rate $\approx 1/\varphi^2 \approx 0.382$ per hop (where $\varphi$ is the golden ratio), and is empirically less than $0.264$ in absolute value across all $3\,348\,675$ edges in trees on $n \le 18$.
The distance-1 contribution admits an exact formula (Proposition~\ref{prop:s1-formula}), with $|S_1| < 0.355$; the tail from distances $2$ and beyond alternates in sign and partially cancels $S_1$ in $90\%$ of edges.
For all parameterised families tested (paths, stars, caterpillars, tripods, brooms) through $n = 300$, the maximum $|\text{remote}|$ converges and never exceeds~$0.254$.
Second, prove Conjecture~A, perhaps via the mean bound $\mu < n/3$; the extremal spider $S(2^k, 1)$ has gap $n/3 - \mu \to 1/6$, so the bound is tight.
The compensation condition~\eqref{eq:whnc} provides a more direct path: Propositions~\ref{prop:singleton} and~\ref{prop:mixed-single} together cover all $S \subseteq H$ with at most one non-leaf heavy vertex, and in all 931\,596 trees tested through $n = 23$, the tightest subset is always a singleton.
On the positive side, the leaf-attachment asymptotics (Theorem~\ref{thm:leaf-attach}) already rule out one natural source of counterexamples: for any fixed core, the near-miss ratio satisfies $\nm(s) = 1 - C/s + O(1/s^2)$ with $C \ge 4$, so adding pendant leaves always preserves unimodality for large~$s$.

The hard-core model tools developed here~-- the edge bound, Hub Exclusion, and the occupation probability framework~-- also have applications to biological network analysis, where tree-like backbones arise in protein interaction and phylogenetic networks; these connections are explored in a companion paper (\href{https://github.com/BrettRey/tree-independence-bio}{github.com/BrettRey/tree-independence-bio}).

The conjecture remains unproved, but the computational evidence increasingly constrains the terrain.
Any counterexample must be homeomorphically irreducible (if ECMS and the combined tail condition hold), must have high leaf-degree vertices (by the PNP reduction), and cannot arise from pendant-leaf attachment to a fixed core (by the asymptotic theorem).
The margin of unimodality can be made arbitrarily small~-- multi-arm stars approach the boundary at rate $1/s$~-- but the boundary itself appears inviolable.

All code, data, and reproduction scripts are available at
\href{https://github.com/BrettRey/erdos-problem-993}{github.com/BrettRey/\allowbreak erdos-problem-993}.


\section*{Acknowledgements}

Claude Opus~4.6 (Anthropic) assisted with computational exploration, code development, and manuscript drafting.
Gemini~3~Pro (Google) contributed to computational exploration.
I take responsibility for all claims and any errors.

\appendix

\section{Reproducibility}\label{app:repro}

Computations through $n = 26$ were run on an Apple M4 (arm64) with 32\,GB RAM, running macOS.
The $n = 27$ search used Modal cloud compute with 1024 parallel workers (78~minutes wall time).
Software versions: Python~3.14.2, NumPy~2.4.2, NetworkX~3.6.1, nauty/geng~2.9301 (32-bit).

\begin{verbatim}
pip install networkx numpy
brew install nauty

# Unit tests (37 tests)
python3 -m unittest test_all.py -v

# Exhaustive search, n <= 26 (8 workers, requires geng)
python3 search.py --max-n 26 --workers 8

# n = 27 (Modal cloud compute, 1024 workers)
# App ID: ap-T9RkZ9fGOtXyvZgPEuYBkZ
modal run search_modal.py

# Targeted family search (n up to 500)
python3 targeted.py --max-n 500 --random-count 5000

# Evolutionary nm optimizer (multi-arm star search)
python3 nm_optimizer.py --min-n 50 --max-n 200
\end{verbatim}

Random seeds are fixed (\texttt{random.Random(42)}) in \texttt{targeted.py}, ensuring deterministic reproduction.
Per-family breakdowns are archived in \texttt{results/targeted\_families.json}.


\section{Computational certificates}\label{app:certificates}

Table~\ref{tab:certificates} summarizes all verified properties.

\begin{table}[ht]
  \centering
  \caption{Computational certificates.  All checks found zero violations.}
  \label{tab:certificates}
  \begin{tabular}{l r r}
    \toprule
    Property & Count & $n$ range \\
    \midrule
    Unimodality (exhaustive) & \liningnums{1\,198\,738\,056} trees & $\le 27$ \\
    LC (exhaustive, $n \le 25$) & \liningnums{167\,879\,146} trees & $\le 25$ \\
    $I(T_e) = I(T) + x I(T/e)$ & \liningnums{66\,697} edges & $\le 14$ \\
    ECMS & \liningnums{24\,710\,099} edges & $\le 20$ \\
    $A(x)$ unimodal and LC & \liningnums{9\,071\,864} edges & $\le 19$ \\
    Combined tail & \liningnums{9\,071\,864} edges & $\le 19$ \\
    $x R_u R_v$ ascending before mode & \liningnums{24\,710\,099} edges & $\le 20$ \\
    $|\delta(T, v)| \le 1$ & \liningnums{26\,056\,121} pairs & $\le 20$ \\
    Conjecture A & \liningnums{931\,596} trees & $\le 23$ \\
    $\mu < n/3$ ($\dleaf \le 1$) & \liningnums{931\,596} trees & $\le 23$ \\
    Compensation~\eqref{eq:whnc} ($\dleaf \le 1$) & \liningnums{931\,596} trees & $\le 23$ \\
    Singleton argmin & \liningnums{931\,596} trees & $\le 23$ \\
    Case B bound & \liningnums{8\,710\,881} trees & $\le 22$ \\
    $S_1$ formula (Prop.~\ref{prop:s1-formula}) & \liningnums{3\,348\,674} edges & $\le 18$ \\
    $|\delta\mu| < 0.537$ & \liningnums{3\,348\,675} edges & $\le 18$ \\
    LC ($\dleaf \le 1$ trees) & \liningnums{931\,596} trees & $\le 23$ \\
    $\mathrm{mode} \le \lceil\mu\rceil$ (all trees) & \liningnums{205\,002} trees & $\le 18$ \\
    $\mathrm{mode} \in \{\lfloor\mu\rfloor, \lceil\mu\rceil\}$ ($\dleaf \le 1$) & \liningnums{175\,722} trees & $\le 21$ \\
    Tie-fugacity: $\mu(\lambda_m) \ge m-1$ ($\dleaf \le 1$) & \liningnums{931\,596} trees & $\le 23$ \\
    \bottomrule
  \end{tabular}
\end{table}


\section{Verification checklist}\label{app:verify}

\begin{enumerate}
  \item Tree counts match OEIS A000055 at every~$n$.
    The search halts on any mismatch.

  \item For $n \le 10$, independence polynomials computed via the geng pipeline match those from NetworkX tree generation exactly.

  \item The two LC-failing trees at $n = 26$ from \textcite{kadrawi2023} were independently reproduced: exactly two failures, both at $k = 13$, with ratios $1.145$ and~$1.030$.

  \item All log-concavity checks use $i_{k-1}\, i_{k+1}$ vs.\ $i_k^2$ in exact integer arithmetic.

  \item The overflow guard for polynomial multiplication triggers automatic fallback to pure Python big-integer arithmetic when coefficient products approach $2^{62}$.

  \item 37 unit tests cover: polynomial correctness on small graphs, unimodality and LC checks, near-miss ratio computation, graph6 parsing, and tree generation.
\end{enumerate}

\newpage
\printbibliography

\end{document}
